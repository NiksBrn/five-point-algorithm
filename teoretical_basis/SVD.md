## Сингулярное разложение (SVD)
Для любой вещественной матрицы $A \in \mathbb{R}^{m \times n}$ существует разложение:
$$
A = U\Sigma V^T
$$
где:

$U \in \mathbb{R}^{m \times m}$ - ортогональная матрица ($U^T U = I_m$)

$\Sigma \in \mathbb{R}^{m \times n}$ - диагональная матрица с неотрицательными элементами (сингулярными значениями)

$V \in \mathbb{R}^{n \times n}$ - ортогональная матрица ($V^T V = I_n$)

Сингулярные значения $\sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r > 0$, где $r = \text{rank}(A)$.

### Ортогональность и ортонормированность
Система векторов ${q_1, \dots, q_k}$ называется:

Ортогональной, если $\langle q_i, q_j \rangle = 0$ при $i \neq j$

Ортонормированной, если она ортогональна и $|q_i| = 1$ для всех $i$

#### Ключевое наблюдение:
$$
A^TA=(V\Sigma ^TU^T)(U\Sigma V^T)=V(\Sigma^T\Sigma)V^T
$$
Это показывает, что:

Столбцы $V$ — собственные векторы $A^TA$

$\sigma_i^2$ — собственные значения $A^TA$

И так, вместо прямого вычисления SVD можно:
* Найти собственные векторы $A^TA$ или $AA^T$
* Взять квадратные корни из собственных значений
* Восстановить вторую матрицу сингулярных векторов
## QR-разложение и алгоритм Грама-Шмидта
QR-алгоритм — это численный метод в линейной алгебре, предназначенный для решения полной проблемы собственных значений, то есть отыскания всех собственных чисел и собственных векторов матрицы. 
### QR-разложение
Для матрицы $A \in \mathbb{R}^{m \times n}$ с линейно независимыми столбцами:
$$
A_k=Q_kR_k
$$
где:

$Q_k \in \mathbb{R}^{m \times n}$ - матрица с ортонормированными столбцами

$R_k \in \mathbb{R}^{n \times n}$ - верхняя треугольная матрица

$A_{k+1} = R_kQ_k$.
Заметим, что
$$
{\displaystyle A_{k+1}=R_{k}Q_{k}=Q_{k}^{-1}Q_{k}R_{k}Q_{k}=Q_{k}^{-1}A_{k}Q_{k}=Q_{k}^{T}A_{k}Q_{k},}
$$
то есть все матрицы $A_k$ являются подобными, то есть их собственные значения равны.

Пусть все диагональные миноры матрицы A не вырождены. Тогда последовательность матриц Ak при ${\displaystyle k\to \infty ,}$ сходится по форме к клеточному правому треугольному виду, соответствующему клеткам с одинаковыми по модулю собственными значениями.

Для того, чтобы получить собственные векторы матрицы, нужно перемножить все матрицы Qk.

Алгоритм считается вычислительно устойчивым, т. к. производится ортогональными преобразованиями подобия.

### Алгоритм Грама-Шмидта
Алгоритм Грама-Шмидта — это способ построения $Q$:

Берём столбцы $A$: $a_1, a_2, ..., a_n$

Последовательно их ортогонализуем и нормализуем

Математическая формулировка:
Для столбцов $a_1, \dots, a_n$ матрицы $A$:

Первый вектор: $q_1 = \frac{a_1}{|a_1|}$

Для j = 2, ..., n:
$$
v_j = a_j - \sum _{k=1}^{j-1} \langle a_j, q_k \rangle q_k \\
$$
$$
q_j = \frac{v_j}{\| v_j \|}
$$
Геометрическая интерпретация:
На каждом шаге из текущего вектора вычитаем его проекцию на все предыдущие ортонормированные векторы, затем нормализуем результат.


## Итоговый Pipeline 
Задача SVD: найти A = UΣVᵀ
    ↓
Найти собственные векторы AᵀA → получаем V и σ²
    ↓
Использовать QR-алгоритм для AᵀA
    ↓
QR-алгоритм делает: B_{k+1} = R_kQ_k
    ↓
Нужно QR-разложение на каждой итерации
    ↓
Делаем его через Грама-Шмидта: B_k = Q_kR_k
    ↓
Получаем собственные векторы V
    ↓
Вычисляем сингулярные значения σ = √λ
    ↓
Вычисляем U из A, V и Σ
    ↓
Получаем полное SVD: A = UΣVᵀ